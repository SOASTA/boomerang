<%= header %>
<!--
IE9 (and older) and phantomjs do not fire 'loadend' for XHRs, no autoxhr beacon was being sent
-->
<script src="52-xhr-response-url.js" type="text/javascript"></script>
<%= boomerangScript %>
<script>
	var numBeacons = 1;
	numBeacons += BOOMR.plugins.AutoXHR ? 2 : 0;
	numBeacons += BOOMR_test.isFetchApiSupported() ? 2 : 0;
	BOOMR_test.init({
		testAfterOnBeacon: numBeacons,
		instrument_xhr: true,
		autorun: true,
		AutoXHR: {
			monitorFetch: true,
			alwaysSendXhr: true
		},
		afterFirstBeacon:
			function () {
				if (!BOOMR.plugins.AutoXHR) {
					return;
				}

				var xhr1 = new XMLHttpRequest();
				xhr1.open("GET", "/302?to=/blackhole/test");
				xhr1.send(null);

				var xhr2 = new XMLHttpRequest();
				xhr2.open("GET", "/blackhole");
				xhr2.send(null);

				if (BOOMR_test.isFetchApiSupported()) {
					fetch("/302?to=/blackhole/test")
						.then(response => console.log(response));
					fetch("/blackhole")
						.then(response => console.log(response));
				}
			}
	});
</script>
<%= footer %>
